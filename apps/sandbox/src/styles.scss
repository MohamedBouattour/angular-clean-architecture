// Theme variables (light/dark) - must come first
@use './styles/theme' as *;

// Material Design
@import "@angular/material/prebuilt-themes/indigo-pink.css";

// Material Icons
@import url('https://fonts.googleapis.com/icon?family=Material+Icons');

// Global Resets
html,
body {
  height: 100%;
  margin: 0;
  font-family: Roboto, "Helvetica Neue", sans-serif;
}

// Apply theme colors to body
body {
  background-color: var(--color-bg);
  color: var(--color-text);
}

// Card styling
.mat-mdc-card {
  background-color: var(--color-bg-card) !important;
  color: var(--color-text) !important;

  .mat-mdc-card-header {
    .mat-mdc-card-title {
      color: var(--color-text) !important;
    }

    .mat-mdc-card-subtitle {
      color: var(--color-text-secondary) !important;
    }
  }

  .mat-mdc-card-content {
    color: var(--color-text) !important;
  }

  .mat-mdc-card-actions {
    color: var(--color-text) !important;
  }
}

// Toolbar theming
.mat-toolbar {
  &.mat-primary {
    background: linear-gradient(135deg, var(--color-primary-dark), var(--color-primary));
    color: white;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    position: relative;
    z-index: 10;
  }
}

// Sidenav theming
.mat-sidenav {
  background-color: var(--color-bg-elevated) !important;
  border-right: 1px solid var(--color-border);
}

// Dialog theming
.mat-mdc-dialog-container {
  --mdc-dialog-container-color: var(--color-bg-card);
}

.mat-mdc-dialog-surface {
  background-color: var(--color-bg-card) !important;
}

.mat-mdc-dialog-title {
  color: var(--color-text) !important;
}

.mat-mdc-dialog-content {
  color: var(--color-text-secondary) !important;
}

// Table theming
.mat-mdc-table {
  background-color: var(--color-bg-card) !important;
}

.mat-mdc-header-cell {
  color: var(--color-text) !important;
}

.mat-mdc-cell {
  color: var(--color-text-secondary) !important;
}

// Form field theming for dark mode
.mat-mdc-form-field {
  --mdc-filled-text-field-container-color: var(--color-bg-elevated);
  --mdc-filled-text-field-label-text-color: var(--color-text-secondary);
  --mdc-filled-text-field-input-text-color: var(--color-text);
  --mdc-filled-text-field-caret-color: var(--color-primary);
  --mdc-filled-text-field-focus-label-text-color: var(--color-primary);
  --mdc-filled-text-field-hover-label-text-color: var(--color-text);
  --mdc-filled-text-field-disabled-label-text-color: var(--color-text-disabled);

  --mdc-outlined-text-field-outline-color: var(--color-border);
  --mdc-outlined-text-field-hover-outline-color: var(--color-text-secondary);
  --mdc-outlined-text-field-focus-outline-color: var(--color-primary);
  --mdc-outlined-text-field-label-text-color: var(--color-text-secondary);
  --mdc-outlined-text-field-input-text-color: var(--color-text);
  --mdc-outlined-text-field-caret-color: var(--color-primary);
  --mdc-outlined-text-field-focus-label-text-color: var(--color-primary);
  --mdc-outlined-text-field-hover-label-text-color: var(--color-text);
  --mdc-outlined-text-field-disabled-label-text-color: var(--color-text-disabled);
  --mdc-outlined-text-field-disabled-outline-color: var(--color-border);

  // Mat form field specific overrides
  --mat-form-field-container-text-color: var(--color-text);
  --mat-form-field-state-layer-color: transparent;
}

// Floating label colors - explicit overrides
.mat-mdc-floating-label {
  color: var(--color-text-secondary) !important;
}

.mdc-floating-label {
  color: var(--color-text-secondary) !important;
}

.mdc-floating-label--float-above {
  color: var(--color-text-secondary) !important;
}

// Focused label
.mat-mdc-form-field.mat-focused .mat-mdc-floating-label,
.mat-mdc-form-field.mat-focused .mdc-floating-label {
  color: var(--color-primary) !important;
}

// Mat label inside form field
.mat-mdc-form-field .mdc-text-field__input {
  color: var(--color-text) !important;
}

// Notched outline label
.mdc-notched-outline__notch {
  border-color: var(--color-border) !important;
}

.mat-mdc-text-field-wrapper {
  background-color: var(--color-bg-elevated) !important;
}

.mdc-text-field--filled:not(.mdc-text-field--disabled) {
  background-color: var(--color-bg-elevated) !important;
}

// Outlined text field specific
.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,
.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,
.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing {
  border-color: var(--color-border) !important;
}

.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,
.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,
.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing {
  border-color: var(--color-text-secondary) !important;
}

.mat-mdc-form-field-focus-overlay {
  background-color: transparent !important;
}

// Input text color
.mat-mdc-input-element {
  color: var(--color-text) !important;
  caret-color: var(--color-primary) !important;
}

// Select/dropdown theming
.mat-mdc-select {
  --mat-select-trigger-text-color: var(--color-text);
  --mat-select-enabled-arrow-color: var(--color-text-secondary);
  --mat-select-focused-arrow-color: var(--color-primary);
}

.mat-mdc-select-panel {
  background-color: var(--color-bg-card) !important;
}

.mat-mdc-option {
  --mat-option-label-text-color: var(--color-text);

  &:hover:not(.mdc-list-item--disabled) {
    background-color: var(--color-bg-elevated) !important;
  }

  &.mdc-list-item--selected:not(.mdc-list-item--disabled) {
    background-color: rgba(var(--color-primary), 0.12) !important;
  }
}

// Menu theming
.mat-mdc-menu-panel {
  background-color: var(--color-bg-card) !important;
}

.mat-mdc-menu-item {
  color: var(--color-text) !important;

  &:hover:not([disabled]) {
    background-color: var(--color-bg-elevated) !important;
  }
}

// Checkbox theming
.mat-mdc-checkbox {
  --mdc-checkbox-unselected-icon-color: var(--color-text-secondary);
  --mdc-checkbox-selected-checkmark-color: white;

  .mdc-label {
    color: var(--color-text) !important;
  }
}

// Button theming
.mat-mdc-button.mat-unthemed {
  color: var(--color-text) !important;
}

// Raised button theming
.mat-mdc-raised-button {
  &.mat-primary {
    --mdc-protected-button-container-color: var(--color-primary);
    --mdc-protected-button-label-text-color: white;
  }

  &:not(.mat-primary):not(.mat-accent):not(.mat-warn) {
    --mdc-protected-button-container-color: var(--color-bg-elevated);
    --mdc-protected-button-label-text-color: var(--color-text);
  }
}

// Flat button theming
.mat-mdc-unelevated-button {
  &.mat-primary {
    --mdc-filled-button-container-color: var(--color-primary);
    --mdc-filled-button-label-text-color: white;
  }
}

// Dialog action buttons
.mat-mdc-dialog-actions {
  .mat-mdc-button {
    color: var(--color-text) !important;
  }

  .mat-mdc-raised-button.mat-primary,
  .mat-mdc-unelevated-button.mat-primary {
    background-color: var(--color-primary) !important;
    color: white !important;
  }

  .mat-mdc-raised-button:disabled,
  .mat-mdc-unelevated-button:disabled {
    background-color: var(--color-bg-elevated) !important;
    color: var(--color-text-disabled) !important;
  }
}

// Snackbar theming
.mat-mdc-snack-bar-container {
  --mdc-snackbar-container-color: var(--color-bg-elevated);
  --mdc-snackbar-supporting-text-color: var(--color-text);
}

// Outlined text field - dark mode background fix
.mdc-text-field--outlined {
  background-color: var(--color-bg-card) !important;

  .mdc-text-field__input {
    color: var(--color-text) !important;

    &::placeholder {
      color: var(--color-text-disabled) !important;
    }
  }
}

// Form field error messages
.mat-mdc-form-field-error {
  color: var(--color-error) !important;
}

.mat-mdc-form-field-hint {
  color: var(--color-text-secondary) !important;
}

// Auth forms specific styling
.auth-container {
  .mat-mdc-card {
    background-color: var(--color-bg-card) !important;
    border: 1px solid var(--color-border);
  }

  .mat-mdc-form-field {
    width: 100%;
  }

  .error-banner {
    background-color: rgba(244, 67, 54, 0.2) !important;
    color: var(--color-error) !important;
    border: 1px solid var(--color-error);
  }

  p {
    color: var(--color-text-secondary);
  }

  a {
    color: var(--color-primary) !important;

    &:hover {
      text-decoration: underline;
    }
  }
}

// Input autofill fix for dark mode
input:-webkit-autofill,
input:-webkit-autofill:hover,
input:-webkit-autofill:focus,
input:-webkit-autofill:active {
  -webkit-box-shadow: 0 0 0 30px var(--color-bg-card) inset !important;
  -webkit-text-fill-color: var(--color-text) !important;
  caret-color: var(--color-text) !important;
}

// Toast notification styles - Forceful overrides for correct coloring
.toast-success {
  --mdc-snackbar-container-color: #4caf50 !important;
  --mdc-snackbar-supporting-text-color: white !important;
  --mat-mdc-snack-bar-button-color: white !important;

  .mdc-snackbar__surface {
    background-color: #4caf50 !important;
  }
}

.toast-error {
  --mdc-snackbar-container-color: #f44336 !important;
  --mdc-snackbar-supporting-text-color: white !important;
  --mat-mdc-snack-bar-button-color: white !important;

  .mdc-snackbar__surface {
    background-color: #f44336 !important;
  }
}

.toast-info {
  --mdc-snackbar-container-color: #2196f3 !important;
  --mdc-snackbar-supporting-text-color: white !important;
  --mat-mdc-snack-bar-button-color: white !important;

  .mdc-snackbar__surface {
    background-color: #2196f3 !important;
  }
}

.toast-warning {
  --mdc-snackbar-container-color: #ff9800 !important;
  --mdc-snackbar-supporting-text-color: white !important;
  --mat-mdc-snack-bar-button-color: white !important;

  .mdc-snackbar__surface {
    background-color: #ff9800 !important;
  }
}

// Common styles for all custom toasts
.toast-success,
.toast-error,
.toast-info,
.toast-warning {
  .mat-mdc-snack-bar-label {
    color: white !important;
    font-weight: 500;
    font-size: 0.95rem;
  }

  .mat-mdc-button {
    color: white !important;
    font-weight: 600;
  }

  // Ensure shadow matches the color (using a generic shadow for now to keep it simple but colored)
  &.toast-success {
    box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4) !important;
  }

  &.toast-error {
    box-shadow: 0 4px 12px rgba(244, 67, 54, 0.4) !important;
  }

  &.toast-info {
    box-shadow: 0 4px 12px rgba(33, 150, 243, 0.4) !important;
  }

  &.toast-warning {
    box-shadow: 0 4px 12px rgba(255, 152, 0, 0.4) !important;
  }
}

// Enhanced toast animations and positioning
.mat-mdc-snack-bar-container {

  &.toast-success,
  &.toast-error,
  &.toast-info,
  &.toast-warning {
    border-radius: 8px !important;
    min-width: 300px;

    .mat-mdc-snack-bar-label {
      font-size: 0.95rem;
      line-height: 1.5;
    }
  }
}